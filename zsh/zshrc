# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

if [ -f "/opt/homebrew//opt/antidote/share/antidote/antidote.zsh" ]; then
  antidote_dir=/opt/homebrew//opt/antidote/share/antidote
  source ${antidote_dir}/antidote.zsh
elif [ -f "/usr/share/zsh-antidote/antidote.zsh" ]; then
  antidote_dir=/usr/share/zsh-antidote
  source ${antidote_dir}/antidote.zsh
else
  antidote_dir=""
  echo "Antidote not found"
fi

if [ -f "$HOME/.dotfiles/core.sh" ]; then
  source "$HOME/.dotfiles/core.sh"
fi

if [ -f "${DOTFILES_DIR}/zsh/p10k.zsh"  ]; then
  source "${DOTFILES_DIR}/zsh/p10k.zsh"
fi

if [ -f "$HOME/.config/broot/launcher/bash/br" ]; then
  source "$HOME/.config/broot/launcher/bash/br"
fi

if [ -f "$HOME/.config/op/plugins.sh" ]; then
  source "$HOME/.config/op/plugins.sh"
fi

# oh-my-zsh config
CASE_SENSITIVE="true"
COMPLETION_WAITING_DOTS="true"
DISABLE_AUTO_UPDATE="true"
DISABLE_UNTRACKED_FILES_DIRTY="true"
HIST_STAMPS="yyyy-mm-dd"
DISABLE_VENV_CD=1

zsh_plugins=${HOME}/.zsh_plugins

# Ensure the .zsh_plugins.txt file exists so you can add plugins.
[[ -f ${zsh_plugins}.txt ]] || touch ${zsh_plugins}.txt

# Lazy-load antidote from its functions directory.
fpath=(${antidote_dir}/functions $fpath)
autoload -Uz antidote

# Generate a new static file whenever .zsh_plugins.txt is updated.
if [[ ! ${zsh_plugins}.zsh -nt ${zsh_plugins}.txt ]]; then
  antidote bundle <${zsh_plugins}.txt >|${zsh_plugins}.zsh
fi

# Source your static plugins file.
source ${zsh_plugins}.zsh

alias g="jump"
alias s="bookmark"
alias d="deletemark"
alias p="showmarks"
alias vi="nvim"
alias vim="nvim"
alias ls="eza"
alias ll="eza -lah"
alias tree="eza --tree"
alias mr="mise run --"
alias "?"="gh copilot suggest -t shell"

autoload -Uz promptinit && promptinit && prompt powerlevel10k
